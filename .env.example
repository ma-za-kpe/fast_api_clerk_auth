# ================================================
# CORE CONFIGURATION
# ================================================

# Application Settings
ENVIRONMENT=development
DEBUG=true
APP_NAME="FastAPI Clerk Auth"
SECRET_KEY=your-super-secret-key-change-this-in-production
API_PREFIX=/api/v1
FRONTEND_URL=http://localhost:3000
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:8000

# ================================================
# CLERK CONFIGURATION
# ================================================

CLERK_SECRET_KEY=sk_test_your_secret_key_here
CLERK_PUBLISHABLE_KEY=pk_test_your_publishable_key_here
CLERK_JWT_VERIFICATION_KEY=your_jwt_verification_key_here
CLERK_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# ================================================
# DATABASE CONFIGURATION
# ================================================

# PostgreSQL
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/clerk_auth
DATABASE_POOL_SIZE=20
DATABASE_MAX_OVERFLOW=40

# Redis
REDIS_URL=redis://localhost:6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_POOL_SIZE=10

# ================================================
# SMS SERVICE (TWILIO)
# ================================================

SMS_PROVIDER=twilio  # Options: twilio, aws_sns, development
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_PHONE_NUMBER=+1234567890
TWILIO_MESSAGING_SERVICE_SID=  # Optional, use instead of phone number
MAX_SMS_PER_PHONE_PER_DAY=10
MAX_SMS_PER_PHONE_PER_HOUR=5

# ================================================
# EMAIL CONFIGURATION
# ================================================

# SMTP Settings
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USER=your-email@example.com
SMTP_PASSWORD=your-app-password
SMTP_USE_TLS=true
FROM_EMAIL=noreply@example.com
FROM_NAME="FastAPI Auth"

# Email Security
ALLOW_EMAIL_SUBADDRESS=true
CHECK_EMAIL_DELIVERABILITY=false
STRICT_EMAIL_VALIDATION=true
CHECK_DISPOSABLE_API=false
DEBOUNCE_API_KEY=  # Optional, for advanced email validation
HIBP_API_KEY=  # Optional, for breach checking

# ================================================
# OAUTH PROVIDERS
# ================================================

# Google OAuth
GOOGLE_CLIENT_ID=your_google_client_id
GOOGLE_CLIENT_SECRET=your_google_client_secret

# GitHub OAuth
GITHUB_CLIENT_ID=your_github_client_id
GITHUB_CLIENT_SECRET=your_github_client_secret

# Microsoft OAuth
MICROSOFT_CLIENT_ID=your_microsoft_client_id
MICROSOFT_CLIENT_SECRET=your_microsoft_client_secret

# Facebook OAuth
FACEBOOK_CLIENT_ID=your_facebook_client_id
FACEBOOK_CLIENT_SECRET=your_facebook_client_secret

# Discord OAuth
DISCORD_CLIENT_ID=your_discord_client_id
DISCORD_CLIENT_SECRET=your_discord_client_secret

# LinkedIn OAuth
LINKEDIN_CLIENT_ID=your_linkedin_client_id
LINKEDIN_CLIENT_SECRET=your_linkedin_client_secret

# Apple OAuth
APPLE_CLIENT_ID=your_apple_client_id
APPLE_CLIENT_SECRET=your_apple_client_secret_jwt

# Twitter/X OAuth
TWITTER_CLIENT_ID=your_twitter_client_id
TWITTER_CLIENT_SECRET=your_twitter_client_secret

# Slack OAuth
SLACK_CLIENT_ID=your_slack_client_id
SLACK_CLIENT_SECRET=your_slack_client_secret

# Spotify OAuth
SPOTIFY_CLIENT_ID=your_spotify_client_id
SPOTIFY_CLIENT_SECRET=your_spotify_client_secret

# GitLab OAuth
GITLAB_CLIENT_ID=your_gitlab_client_id
GITLAB_CLIENT_SECRET=your_gitlab_client_secret

# Twitch OAuth
TWITCH_CLIENT_ID=your_twitch_client_id
TWITCH_CLIENT_SECRET=your_twitch_client_secret

# TikTok OAuth
TIKTOK_CLIENT_ID=your_tiktok_client_id
TIKTOK_CLIENT_SECRET=your_tiktok_client_secret

# Instagram OAuth
INSTAGRAM_CLIENT_ID=your_instagram_client_id
INSTAGRAM_CLIENT_SECRET=your_instagram_client_secret

# Dropbox OAuth
DROPBOX_CLIENT_ID=your_dropbox_client_id
DROPBOX_CLIENT_SECRET=your_dropbox_client_secret

# Notion OAuth
NOTION_CLIENT_ID=your_notion_client_id
NOTION_CLIENT_SECRET=your_notion_client_secret

# Linear OAuth
LINEAR_CLIENT_ID=your_linear_client_id
LINEAR_CLIENT_SECRET=your_linear_client_secret

# Box OAuth
BOX_CLIENT_ID=your_box_client_id
BOX_CLIENT_SECRET=your_box_client_secret

# HubSpot OAuth
HUBSPOT_CLIENT_ID=your_hubspot_client_id
HUBSPOT_CLIENT_SECRET=your_hubspot_client_secret

# Atlassian OAuth
ATLASSIAN_CLIENT_ID=your_atlassian_client_id
ATLASSIAN_CLIENT_SECRET=your_atlassian_client_secret

# Bitbucket OAuth
BITBUCKET_CLIENT_ID=your_bitbucket_client_id
BITBUCKET_CLIENT_SECRET=your_bitbucket_client_secret

# ================================================
# BOT PROTECTION
# ================================================

# reCAPTCHA v3
RECAPTCHA_V3_SITE_KEY=your_recaptcha_v3_site_key
RECAPTCHA_V3_SECRET_KEY=your_recaptcha_v3_secret_key
RECAPTCHA_V3_THRESHOLD=0.5

# hCaptcha
HCAPTCHA_SITE_KEY=your_hcaptcha_site_key
HCAPTCHA_SECRET_KEY=your_hcaptcha_secret_key

# Cloudflare Turnstile
TURNSTILE_SITE_KEY=your_turnstile_site_key
TURNSTILE_SECRET_KEY=your_turnstile_secret_key

# ================================================
# GEOLOCATION SERVICE
# ================================================

# IP Geolocation Providers (at least one recommended)
IPSTACK_KEY=your_ipstack_api_key
IPAPI_KEY=your_ipapi_key
IPGEOLOCATION_KEY=your_ipgeolocation_key
MAXMIND_ACCOUNT_ID=your_maxmind_account_id
MAXMIND_LICENSE_KEY=your_maxmind_license_key

# Geolocation Security
BLOCKED_COUNTRIES=  # Comma-separated country codes (e.g., KP,IR)
MAX_DISTANCE_THRESHOLD_KM=1000
IMPOSSIBLE_TRAVEL_SPEED_KMH=900

# ================================================
# SECURITY SETTINGS
# ================================================

# Session Configuration
SESSION_LIFETIME=86400  # 24 hours in seconds
REFRESH_TOKEN_LIFETIME=604800  # 7 days in seconds
SESSION_SLIDING_WINDOW=true
MAX_SESSIONS_PER_USER=5

# MFA Settings
MFA_ISSUER_NAME="FastAPI Auth"
TOTP_PERIOD=30
TOTP_DIGITS=6
BACKUP_CODES_COUNT=10
OTP_LENGTH=6
OTP_EXPIRY=300  # 5 minutes
OTP_MAX_SEND_ATTEMPTS=5
OTP_MAX_VERIFY_ATTEMPTS=5
OTP_STRICT_IP=false

# Magic Links
MAGIC_LINK_EXPIRY=900  # 15 minutes
MAGIC_LINK_STRICT_IP=false

# Password Policy
MIN_PASSWORD_LENGTH=8
REQUIRE_UPPERCASE=true
REQUIRE_LOWERCASE=true
REQUIRE_NUMBERS=true
REQUIRE_SPECIAL_CHARS=true
PASSWORD_HISTORY_COUNT=5
PASSWORD_EXPIRY_DAYS=90

# Rate Limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_PERIOD=60
LOGIN_MAX_ATTEMPTS=5
LOGIN_LOCKOUT_DURATION=900  # 15 minutes

# ================================================
# ENTERPRISE SSO
# ================================================

# SAML Configuration
SAML_ENTITY_ID=your_saml_entity_id
SAML_SSO_URL=https://your-app.com/api/v1/sso/saml/acs
SAML_CERTIFICATE_PATH=/path/to/certificate.pem
SAML_PRIVATE_KEY_PATH=/path/to/private_key.pem

# OpenID Connect
OIDC_DISCOVERY_URL=https://your-provider.com/.well-known/openid-configuration
OIDC_CLIENT_ID=your_oidc_client_id
OIDC_CLIENT_SECRET=your_oidc_client_secret

# ================================================
# ANALYTICS & MONITORING
# ================================================

# Prometheus Metrics
ENABLE_METRICS=true
METRICS_PORT=9090

# OpenTelemetry
OTEL_ENABLED=false
OTEL_ENDPOINT=http://localhost:4317
OTEL_SERVICE_NAME=fastapi-auth

# Logging
LOG_LEVEL=INFO
LOG_FILE=logs/app.log
LOG_MAX_SIZE=10485760  # 10MB
LOG_BACKUP_COUNT=5
LOG_FORMAT=json  # Options: json, text

# ================================================
# COMPLIANCE
# ================================================

# GDPR/CCPA Settings
ENABLE_GDPR_COMPLIANCE=true
ENABLE_CCPA_COMPLIANCE=true
DATA_RETENTION_DAYS=365
AUTO_DELETE_INACTIVE_USERS=false
INACTIVE_USER_THRESHOLD_DAYS=365

# Consent Management
DEFAULT_CONSENT_VERSION=1.0
REQUIRE_EXPLICIT_CONSENT=true
CONSENT_RENEWAL_DAYS=365

# ================================================
# BULK OPERATIONS
# ================================================

BULK_MAX_BATCH_SIZE=1000
BULK_CONCURRENT_LIMIT=10
BULK_OPERATION_TIMEOUT=3600  # 1 hour

# ================================================
# FEATURE FLAGS
# ================================================

ENABLE_SOCIAL_AUTH=true
ENABLE_MFA=true
ENABLE_PASSWORDLESS=true
ENABLE_ORGANIZATIONS=true
ENABLE_WEBHOOKS=true
ENABLE_ADMIN_PANEL=true
ENABLE_API_KEYS=true
ENABLE_AUDIT_LOGS=true
ENABLE_DEVICE_MANAGEMENT=true
ENABLE_RBAC=true
ENABLE_ENTERPRISE_SSO=false
ENABLE_COMPLIANCE=true
ENABLE_ANALYTICS=true
ENABLE_BOT_PROTECTION=true
ENABLE_EMAIL_SECURITY=true
ENABLE_GEOLOCATION=true
ENABLE_BULK_OPERATIONS=true

# ================================================
# WEBHOOK CONFIGURATION
# ================================================

WEBHOOK_MAX_RETRIES=3
WEBHOOK_RETRY_DELAY=60
WEBHOOK_TIMEOUT=30
WEBHOOK_SIGNATURE_ALGORITHM=HMAC-SHA256

# ================================================
# FILE UPLOAD
# ================================================

UPLOAD_MAX_SIZE=5242880  # 5MB
ALLOWED_AVATAR_TYPES=image/jpeg,image/png,image/gif,image/webp
AVATAR_MAX_SIZE=2097152  # 2MB
UPLOAD_PATH=/var/uploads

# ================================================
# CELERY (Background Tasks)
# ================================================

CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
CELERY_TASK_ALWAYS_EAGER=false  # Set to true for synchronous execution in development

# ================================================
# CORS SETTINGS
# ================================================

CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS,PATCH
CORS_ALLOW_HEADERS=*
CORS_MAX_AGE=3600

# ================================================
# API DOCUMENTATION
# ================================================

SHOW_API_DOCS=true  # Set to false in production
API_DOCS_URL=/docs
API_REDOC_URL=/redoc

# ================================================
# DEVELOPMENT SETTINGS
# ================================================

# Only for development - disable in production
DEV_MODE=false
AUTO_RELOAD=false
MOCK_EXTERNAL_SERVICES=false
DISABLE_RATE_LIMITS=false
BYPASS_CAPTCHA=false

# ================================================
# BACKUP & RECOVERY
# ================================================

BACKUP_ENABLED=false
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_S3_BUCKET=your-backup-bucket
BACKUP_ENCRYPTION_KEY=your-backup-encryption-key