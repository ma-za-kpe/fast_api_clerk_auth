# ================================================
# PRODUCTION CONFIGURATION
# ================================================
# This file contains production-specific settings
# Copy to .env and fill in actual values for production deployment

# ================================================
# CORE CONFIGURATION
# ================================================

ENVIRONMENT=production
DEBUG=false
APP_NAME="FastAPI Clerk Auth"
SECRET_KEY=CHANGE_THIS_TO_A_SECURE_RANDOM_STRING_MIN_32_CHARS
API_PREFIX=/api/v1
FRONTEND_URL=https://your-production-domain.com
ALLOWED_ORIGINS=https://your-production-domain.com

# ================================================
# CLERK CONFIGURATION (PRODUCTION)
# ================================================

CLERK_SECRET_KEY=sk_live_your_production_secret_key
CLERK_PUBLISHABLE_KEY=pk_live_your_production_publishable_key
CLERK_JWT_VERIFICATION_KEY=your_production_jwt_verification_key
CLERK_WEBHOOK_SECRET=whsec_your_production_webhook_secret

# ================================================
# DATABASE CONFIGURATION (PRODUCTION)
# ================================================

# Use connection pooling and SSL for production
DATABASE_URL=postgresql://username:password@your-db-host:5432/production_db?sslmode=require
DATABASE_POOL_SIZE=50
DATABASE_MAX_OVERFLOW=100

# Use Redis with password and connection pooling
REDIS_URL=redis://:your-redis-password@your-redis-host:6379/0
REDIS_PASSWORD=your-redis-password
REDIS_DB=0
REDIS_POOL_SIZE=50

# ================================================
# SECURITY SETTINGS (PRODUCTION)
# ================================================

# Strict session settings
SESSION_LIFETIME=3600  # 1 hour for production
REFRESH_TOKEN_LIFETIME=86400  # 1 day
SESSION_SLIDING_WINDOW=true
MAX_SESSIONS_PER_USER=3

# Strict MFA settings
OTP_STRICT_IP=true
MAGIC_LINK_STRICT_IP=true

# Strong password policy
MIN_PASSWORD_LENGTH=12
REQUIRE_UPPERCASE=true
REQUIRE_LOWERCASE=true
REQUIRE_NUMBERS=true
REQUIRE_SPECIAL_CHARS=true
PASSWORD_HISTORY_COUNT=10
PASSWORD_EXPIRY_DAYS=60

# Aggressive rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=50
RATE_LIMIT_PERIOD=60
LOGIN_MAX_ATTEMPTS=3
LOGIN_LOCKOUT_DURATION=1800  # 30 minutes

# ================================================
# EMAIL CONFIGURATION (PRODUCTION)
# ================================================

# Use a production email service (SendGrid, AWS SES, etc.)
SMTP_HOST=smtp.sendgrid.net
SMTP_PORT=587
SMTP_USER=apikey
SMTP_PASSWORD=your-sendgrid-api-key
SMTP_USE_TLS=true
FROM_EMAIL=noreply@your-domain.com
FROM_NAME="Your Company Name"

# Strict email validation
ALLOW_EMAIL_SUBADDRESS=false
CHECK_EMAIL_DELIVERABILITY=true
STRICT_EMAIL_VALIDATION=true
CHECK_DISPOSABLE_API=true

# ================================================
# BOT PROTECTION (PRODUCTION)
# ================================================

# Enable all bot protection in production
RECAPTCHA_V3_SITE_KEY=your_production_recaptcha_site_key
RECAPTCHA_V3_SECRET_KEY=your_production_recaptcha_secret_key
RECAPTCHA_V3_THRESHOLD=0.7  # Stricter threshold

# ================================================
# GEOLOCATION SECURITY (PRODUCTION)
# ================================================

# Block high-risk countries if needed
BLOCKED_COUNTRIES=KP,IR,SY,CU,SD
MAX_DISTANCE_THRESHOLD_KM=500  # Stricter for production
IMPOSSIBLE_TRAVEL_SPEED_KMH=900

# ================================================
# MONITORING (PRODUCTION)
# ================================================

# Enable all monitoring
ENABLE_METRICS=true
METRICS_PORT=9090

# OpenTelemetry for production monitoring
OTEL_ENABLED=true
OTEL_ENDPOINT=https://your-otel-collector.com:4317
OTEL_SERVICE_NAME=fastapi-auth-production

# Production logging
LOG_LEVEL=WARNING
LOG_FILE=/var/log/fastapi-auth/app.log
LOG_MAX_SIZE=52428800  # 50MB
LOG_BACKUP_COUNT=10
LOG_FORMAT=json

# ================================================
# COMPLIANCE (PRODUCTION)
# ================================================

ENABLE_GDPR_COMPLIANCE=true
ENABLE_CCPA_COMPLIANCE=true
DATA_RETENTION_DAYS=730  # 2 years
AUTO_DELETE_INACTIVE_USERS=true
INACTIVE_USER_THRESHOLD_DAYS=730

# ================================================
# FEATURE FLAGS (PRODUCTION)
# ================================================

# Disable development features
SHOW_API_DOCS=false
DEV_MODE=false
AUTO_RELOAD=false
MOCK_EXTERNAL_SERVICES=false
DISABLE_RATE_LIMITS=false
BYPASS_CAPTCHA=false

# ================================================
# BACKUP & RECOVERY (PRODUCTION)
# ================================================

BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
BACKUP_RETENTION_DAYS=90
BACKUP_S3_BUCKET=your-production-backup-bucket
BACKUP_ENCRYPTION_KEY=your-production-backup-encryption-key

# ================================================
# CORS SETTINGS (PRODUCTION)
# ================================================

CORS_ALLOW_CREDENTIALS=true
CORS_ALLOW_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOW_HEADERS=Authorization,Content-Type,X-Requested-With
CORS_MAX_AGE=86400  # 24 hours

# ================================================
# SSL/TLS (PRODUCTION)
# ================================================

FORCE_HTTPS=true
SSL_REDIRECT=true
HSTS_ENABLED=true
HSTS_MAX_AGE=31536000  # 1 year

# ================================================
# CDN & STATIC FILES (PRODUCTION)
# ================================================

CDN_URL=https://cdn.your-domain.com
STATIC_FILES_PATH=/var/www/static
MEDIA_FILES_PATH=/var/www/media

# ================================================
# PERFORMANCE (PRODUCTION)
# ================================================

# Worker configuration
WORKERS=4  # Adjust based on CPU cores
WORKER_CLASS=uvicorn.workers.UvicornWorker
WORKER_CONNECTIONS=1000
KEEPALIVE=5

# Database optimizations
DATABASE_STATEMENT_TIMEOUT=30000  # 30 seconds
DATABASE_IDLE_TRANSACTION_TIMEOUT=60000  # 60 seconds

# Cache optimizations
CACHE_DEFAULT_TIMEOUT=300
CACHE_KEY_PREFIX=prod_